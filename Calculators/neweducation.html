<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    <link rel="stylesheet" href="css/jquery.mobile-1.4.1.css" type="text/css" />
    <link rel="stylesheet" href="formcss.css" type="text/css" />
    <script src="js/jquery-1.9.1.js" type="text/javascript"></script>
    <script src="js/jquery.mobile-1.4.1.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <script type="text/javascript" src="js/highcharts.js"></script>
    <script type="text/javascript" src="js/exporting.js"></script>
    <script type="text/javascript" src="js/export-data.js"></script>
    <script type="text/javascript" src="js/accessibility.js"></script>
</head>

<body>
    <div class="row">
        <div class="col-md-12" align="center" style="padding: 10px; font-size: 18px;">
            <img src="../img/coloreducation.svg" alt="fb-logo" class="clor-icon"> Child's Education Calculator
        </div>
    </div>
    <div id="printDiv" class="row nomargin calcBg">
        <div class="col-md-6 col-sm-6 col-xs-12 nopadding calcInpDiv">
            <div id="hide" style="display:block;">
                <div class="col-md-12 nopadding">
                    <div class="col-md-12 col-sm-12 col-xs-12 bar_padding">
                        <label for="slider-fill">After how many years will your child begin higher studies ?</label>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input class="progress" type="range" name="slider-fill" id="Years" value="3" min="1" max="30"
                            step="1" data-highlight="true" onchange="Calculate()">
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-md-12 nopadding">
                    <div class="col-md-12 col-sm-12 col-xs-12 bar_padding">
                        <label for="slider-fill">How much do does the higher Education cost today ?</label>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input class="progress" type="range" name="slider-fill" id="Cost" value="200000" min="100000"
                            max="300000000" step="100000" data-highlight="true" onchange="Calculate()">
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-md-12 nopadding">
                    <div class="col-md-12 col-sm-12 col-xs-12 bar_padding">
                        <label for="slider-fill">How much money can you set aside for your childâ€™s higher studies at
                            the moment ?</label>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input class="progress" type="range" name="slider-fill" id="PV" value="50000" min="0"
                            max="3000000" step="100000" data-highlight="true" onchange="Calculate()">
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-md-12 nopadding">
                    <div class="col-md-12 col-sm-12 col-xs-12 bar_padding">
                        <label for="slider-fill">Inflation Rate</label>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input class="progress" type="range" name="slider-fill" id="inflation" value="7" min="0"
                            max="20" step="1" data-highlight="true" onchange="Calculate()">
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-md-12 nopadding">
                    <div class="col-md-12 col-sm-12 col-xs-12 bar_padding">
                        <label for="slider-fill">Rate Of Return</label>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input class="progress" type="range" name="slider-fill" id="ror" value="9" min="0" max="60"
                            step="1" data-highlight="true" onchange="Calculate()">
                    </div>
                </div>
                <!-- <div class="clearfix"></div>
                <div class="col-md-12 nopadding resp_1080">
                    <div class="col-md-6 col-sm-6 col-xs-12 nopadding">             
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-6 res_480_cal">
                        <input type='submit' value='Calculate' class='form_button' onclick="Calculate()">
                    </div>
                </div> -->
                <div class="clearfix"></div>
            </div>
            <div id="hide2" style="display:none;padding: 0 15px;">
                <div class="row nomargin">
                    <div class="col-md-12 nopadding">
                        <span id='phpfmg_processing' style='display:none;'>
                            <img id='phpfmg_processing_gif' src='admin1500.gif?mod=image&amp;func=processing' border=0
                                alt='Processing...'>
                            <label id='phpfmg_processing_dots'></label>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-sm-6 col-xs-12 nopadding calcChartDiv">
            <div id="benefits">
                <div class="row nomargin">
                    <div class="col-md-12 result_bar">
                        <div class="col-md-12 col-sm-12 col-xs-12 nopadding resp_480_result">
                            <div class="row nomargin">
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding">
                                    <label>Cost In Future terms : </label>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding resultText">
                                    &#8377; <span id="Cost_display"></span>
                                </div>
                            </div>
                            <hr color="#C1C1C1" />
                            <div class="row nomargin">
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding">
                                    <label>Existing Investment:</label>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding resultText">
                                    &#8377; <span id="FVexisting_display"></span>
                                </div>
                            </div>
                            <hr color="#C1C1C1" />
                            <div class="row nomargin">
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding">
                                    <label>Monthly Savings From Today :</label>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-6 nopadding resultText">
                                    &#8377; <span id="SIP_display"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-sm-12 col-xs-12 nopadding pie_resp_600">
                            <div id="piechart" class="piechart"></div>
                            <div id="graph-images" style="display:none"></div>
                        </div>
                    </div>
                    <!-- <div class="clearfix"></div>
                    <div class="col-md-12 nopadding">        	
            <div class="button" onclick="backpage()">Back</div>
       	</div>	 -->
                </div>
                <!-- <div class="row nomargin">
                    <div class="col-md-6"></div>
                    <div class="col-md-6" align="right" style="padding: 0 25px 10px 0">
                        <a onclick="window.location.reload()">Reset Calculator</a>
                    </div>
                </div> -->
            </div>
        </div>
    </div>

    <!-- <div class="row nomargin">
    <div class="col-md-12 col-sm-12 col-xs-12 nopadding">			
        <div class="container">                    
            <input type="button" value="Print PDF"               
            onclick="convertHTMLtoPDF()">
        </div>
    </div>
</div> -->
    <script type="text/javascript">    
            
        var FV;
        var FVexisting;
        function Calculate() {

            var Years = document.getElementById("Years").value;
            var Cost = document.getElementById("Cost").value;
            var PV = document.getElementById("PV").value;
            var inflation = document.getElementById("inflation").value;
            var ror = document.getElementById("ror").value;


            var Power = Math.pow((1 + (ror / 100)), Years);
            var hike = Math.pow((1 + (inflation / 100)), Years);
            var rounding = (ror / 1200);
            var Powerr = Math.pow((1 + rounding), Years * 12);


            var CostFV;
            CostFV = Math.round((Cost * hike));

            FVexisting = Math.round(PV * Power);

            FV = (CostFV - FVexisting);

            var SIP;
            SIP = Math.round([(FV * rounding) / (Powerr - 1)]);

            document.getElementById('Cost_display').innerHTML = numberWithCommas(CostFV);
            document.getElementById('FVexisting_display').innerHTML = numberWithCommas(FVexisting);
            document.getElementById('SIP_display').innerHTML = numberWithCommas(SIP);

            drawChart(FV, FVexisting);

        }

        // google.load("visualization", "1", {packages:["corechart"]});
        // google.setOnLoadCallback(function() {
        //     drawChart(FV, FVexisting);
        // });
        google.charts.load("current", { packages: ["corechart"] });
        google.charts.setOnLoadCallback(function () {
            drawChart(FV, FVexisting);
        });
        function drawChart(FV, FVexisting) {

            var numberschart;
            numberschart = Number(FV);

            /*var data = google.visualization.arrayToDataTable([
                ['Task', 'Hours per Day'],
                ['Shortfall', parseInt(numberschart)],
                ['Provision Made', parseInt(FVexisting)],
            ]);

            var options = {
                title: 'Child Education',
                pieHole: 0.5,
                slices: {
                    0: { color: '#2199c7' }, // Color for Shortfall
                    1: { color: '#ee141f' }, // Color for Provision Made
                },
                pieSliceText: 'percentage',
                tooltip: {
                    text: 'value',
                    // trigger: 'selection'
                },
                chartArea: {
                    width: '100%',
                    height: '94%'
                },
                legend: {
                    textStyle: {
                        fontSize: 13
                    }
                },
                pieResidueSliceColor: "yellow",
                height: '100%',
                width: '100%',
                backgroundColor: '#ffffff'
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));
            // google.visualization.events.addListener(chart, 'ready', function () {
            //     var content = '<img src="' + chart.getImageURI() + '">';
            //     $('#graph-images').empty();
            //     $('#graph-images').append(content);
            // });
            chart.draw(data, options);*/

            var data = [
                ['Shortfall', parseInt(numberschart)],
                ['Provision Made', parseInt(FVexisting)]
            ];

            Highcharts.chart('piechart', {
                chart: {
                    type: 'pie',
                    backgroundColor: 'rgba(154, 206, 235, 0.01)'
                },
                title: {
                    text: ''
                },
                plotOptions: {
                    pie: {
                        innerSize: '80%',
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                        }
                    },
                    /*series: {
                        borderWidth: 0,
                        colorByPoint: true,
                        type: 'pie',
                        size: '80%',
                        innerSize: '80%',
                        dataLabels: {
                            enabled: true,
                            crop: false,
                            distance: '-10%',
                            style: {
                                fontWeight: 'bold',
                                fontSize: '10px'
                            },
                            connectorWidth: 0
                        }
                    }*/
                },
                colors: ['#ff6984', '#56e8cb'],
                series: [{
                    name: 'Value',
                    colorByPoint: true,
                    data: data
                }],
                exporting: {
                    enabled: false
                },
                credits: {
                    enabled: false
                },
                legend: {
                    enabled: false
                }
            });
        }

        function Nextpage() {
            if (document.getElementById('hide').style.display == 'block') {
                document.getElementById('hide').style.display = 'none';
            }
        }

        function Nextpage2() {
            if (document.getElementById('benefits').style.display == 'none') {
                document.getElementById('benefits').style.display = 'block';
            }

            if (document.getElementById('hide2').style.display == 'block') {
                document.getElementById('hide2').style.display = 'none';
            }
        }

        function backpage() {
            if (document.getElementById('hide').style.display == 'none') {
                document.getElementById('hide').style.display = 'block';
            }
            if (document.getElementById('benefits').style.display == 'block') {
                document.getElementById('benefits').style.display = 'none';
            }
        }

        function backpage2() {
            if (document.getElementById('hide2').style.display == 'none') {
                document.getElementById('hide2').style.display = 'block';
            }

            if (document.getElementById('benefits').style.display == 'block') {
                document.getElementById('benefits').style.display = 'none';
            }
        }
        function backpage33() {
            if (document.getElementById('benefits').style.display == 'block') {
                document.getElementById('benefits').style.display = 'none';
            }
        }
        //document.getElementById("benefits").addEventListener("load", Calculate);
        document.addEventListener("DOMContentLoaded", Calculate); 

        function convertHTMLtoPDF() {
            const { jsPDF } = window.jspdf;

            //let doc = new jsPDF('l', 'mm', [1080, 720]);
            //let doc = new jsPDF('l', 'pt', 'letter');
            let doc = new jsPDF('l', 'pt', 'a3', false); /* Creates a new Document*/
            doc.setFontSize(15); /* Define font size for the document */
            let pdfjs = document.querySelector('#printDiv');

            doc.html(pdfjs, {
                callback: function (doc) {
                    //doc.save("newpdf.pdf");
                    var yAxis = 200;
                    var imageTags = $('#graph-images img');
                    for (var i = 0; i < imageTags.length; i++) {
                        if (i % 2 == 0 && i != 0) { /* I want only two images in a page */
                            doc.addPage(); /* Adds a new page*/
                            yAxis = 30; /* Re-initializes the value of yAxis for newly added page*/
                        }
                        var someText = 'Chart ' + (i + 1);
                        //doc.text(60, yAxis, someText); /* Add some text in the PDF */
                        yAxis = yAxis + 20; /* Update yAxis */
                        doc.addImage(imageTags[i], 'png', 600, yAxis, 450, 280, undefined, 'none');
                        yAxis = yAxis + 360; /* Update yAxis */
                    }

                    const d = new Date();
                    const pageSize = doc.internal.pageSize;
                    const pageWidth = pageSize.width ? pageSize.width : pageSize.getWidth();
                    const pageHeight = pageSize.height ? pageSize.height : pageSize.getHeight();
                    const headerL = 'RSave.in';
                    const headerR = 'Child\'s Education Planning';
                    const footerL = `PDF downloaded from rsave.in at: ${d}`;
                    const pageCount = doc.internal.getNumberOfPages();
                    for (let i = 1; i <= pageCount; i++) {
                        doc.setPage(i);
                        const footerR = `Page ${i} of ${pageCount}`;
                        doc.addImage('../image/Companylogo.png', 'png', 40, 15, 50, 25, undefined, 'none');
                        //doc.text(headerL, 40, 15, { align: 'left', baseline: 'top' });
                        doc.text(headerR, pageWidth - 40, 15, { align: 'right', baseline: 'top' });
                        doc.text(footerL, 40, pageHeight - 25, { align: 'left', baseline: 'top' });
                        doc.text(footerR, pageWidth - 40, pageHeight - 25, { align: 'right', baseline: 'top' });
                        //doc.text(footerR, pageWidth / 2 - (doc.getTextWidth(footer) / 2), pageHeight - 15, { baseline: 'bottom' });
                    }
                    doc.save('Chart_Report' + '.pdf'); /* Prompts user to save file on his/her machine */
                },
                x: 12,
                y: 30
            });

        }
    </script>
    <script src="formjs.js" type="text/javascript"></script>
</body>

</html>